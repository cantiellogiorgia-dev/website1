<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { 
            margin: 0; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh; 
            background: #000; /* Sfondo nero totale per far risaltare i punti */
            overflow: hidden;
        }
        canvas {
            display: block;
            max-width: 95vw;
            max-height: 95vh;
            object-fit: contain;
        }
    </style>
</head>
<body>

<script>
let img;
let puntoDim = 2; // Grandezza del punto
let spaziatura = 2; // Distanza tra i punti

function preload() {
    /* CORREZIONE PERCORSO: 
       '../' esce da 'progetto2'

    */
    img = loadImage('../img/r'); 
}

function setup() {
    // Crea il canvas con le dimensioni originali dell'immagine
    createCanvas(img.width, img.height);
    noLoop(); 
}

function draw() {
    background(0); 
    
    // Preparazione dei pixel
    img.loadPixels();

    // Griglia quadrata: salta di (dimensione + spaziatura)
    for (let y = 0; y < img.height; y += (puntoDim + spaziatura)) {
        for (let x = 0; x < img.width; x += (puntoDim + spaziatura)) {
            
            // Preleva il colore del pixel
            let pixColor = img.get(x, y);
            
            // Calcolo luminosità (media dei canali) per non perdere dettagli
            let r_orig = red(pixColor);
            let g_orig = green(pixColor);
            let b_orig = blue(pixColor);
            let luminosita = (r_orig + g_orig + b_orig) / 3;
            
            // Manteniamo la trasparenza originale della PNG
            let a = alpha(pixColor); 

            if (a > 10) { // Disegna solo se non è trasparente
                // FILTRO BLU: 
                // Rosso e Verde a zero, il Blu segue la luminosità dell'immagine
                fill(0, 0, luminosita, a);
                noStroke();
                
                // Disegna il punto quadrato da 2px
                rect(x, y, puntoDim, puntoDim);
            }
        }
    }
}
</script>

</body>
</html>