<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fiore di Occhi Interattivo</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: white;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        canvas {
            display: block;
        }
    </style>
</head>
<body>

<canvas id="canvas1"></canvas>

<script>
const canvas = document.getElementById('canvas1');
const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let particleArray = [];
const mouse = {
    x: null,
    y: null,
    radius: 50 // Raggio di attivazione dell'occhio
}

window.addEventListener('mousemove', function(event) {
    mouse.x = event.x;
    mouse.y = event.y;
});

class Eye {
    constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = 2; // Dimensione del puntino nero
        this.isOpen = false;
    }

    draw() {
        // Calcolo distanza dal mouse
        let dx = mouse.x - this.x;
        let dy = mouse.y - this.y;
        let distance = Math.sqrt(dx * dx + dy * dy);

        if (distance < mouse.radius) {
            // DISEGNO OCCHIO APERTO (Semplice One-Line)
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(this.x, this.y, 6, 0, Math.PI * 2); // Sfondo occhio
            ctx.fill();

            // Linea bianca (palpebra/forma)
            ctx.strokeStyle = 'white';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(this.x - 5, this.y);
            ctx.quadraticCurveTo(this.x, this.y - 6, this.x + 5, this.y); // Superiore
            ctx.quadraticCurveTo(this.x, this.y + 6, this.x - 5, this.y); // Inferiore
            ctx.stroke();

            // Pupilla bianca
            ctx.fillStyle = 'white';
            ctx.beginPath();
            ctx.arc(this.x, this.y, 1.5, 0, Math.PI * 2);
            ctx.fill();
        } else {
            // DISEGNO PUNTINO NERO STANDARD
            ctx.fillStyle = 'black';
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        }
    }
}

const pngImage = new Image();
pngImage.src = "imag/fioreneero.png"
; // Inserisci qui il percorso della tua immagine

pngImage.onload = function() {
    // Centra l'immagine sul canvas
    const startX = (canvas.width / 2) - (pngImage.width / 2);
    const startY = (canvas.height / 2) - (pngImage.height / 2);
    
    ctx.drawImage(pngImage, startX, startY);
    const data = ctx.getImageData(startX, startY, pngImage.width, pngImage.height);
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Analizza l'immagine (ogni 4 pixel per performance)
    for (let y = 0; y < data.height; y += 4) {
        for (let x = 0; x < data.width; x += 4) {
            // Se il pixel Ã¨ nero (o molto scuro)
            if (data.data[(y * 4 * data.width) + (x * 4) + 3] > 128) {
                let positionX = x + startX;
                let positionY = y + startY;
                particleArray.push(new Eye(positionX, positionY));
            }
        }
    }
    animate();
};

function animate() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let i = 0; i < particleArray.length; i++) {
        particleArray[i].draw();
    }
    requestAnimationFrame(animate);
}

window.addEventListener('resize', function() {
    location.reload(); // Ricarica per ricalcolare le posizioni
});
</script>
</body>
</html>