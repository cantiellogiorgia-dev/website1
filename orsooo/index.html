<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>SPOT!MASH - Unique Choreography Edition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { margin: 0; padding: 0; background-color: #E0E0E0; overflow: hidden; font-family: 'Courier New', monospace; cursor: crosshair; }
        canvas { display: block; }
    </style>
</head>
<body>

<script>
let albums = [
    { title: "Toxic", artist: "Playboi Carti, Skepta", row: 0, danceStyle: 0, cover: img = "albumcovers/toxic.jpeg" },
    { title: "What happened to the streets", artist: "21 Savage", row: 0, danceStyle: 1, cover: img = "albumcovers/21savage.jpeg" },
    { title: "Anima macchina", artist: "Sxrrrxwlnd", row: 0, danceStyle: 2, cover: img = "albumcovers/images.jpeg" },
    { title: "Tonypitony", artist: "Tonypitony", row: 0, danceStyle: 3, cover: img = "albumcovers/tony.webp" },
    { title: "Era l’inizio", artist: "EMMA", row: 0, danceStyle: 0, cover: img = "albumcovers/emma.png" },
    { title: "Scarabocchi", artist: "Chiello", row: 1, danceStyle: 1, cover: img = "albumcovers/scarabocchi chuelloo.jpg" },
    { title: "Fessure", artist: "Cedric Blaser", row: 1, danceStyle: 2, cover: img = "albumcovers/fessure.jpg" },
    { title: "Sogni", artist: "i PATAGARRI", row: 1, danceStyle: 3, cover: img = "albumcovers/sogni patagarri.jpg" },
    { title: "Situazione complicata", artist: "Lucio Corsi", row: 1, danceStyle: 0, cover: img = "albumcovers/hq720.jpg"}
];

let loadedCovers = [];
let scrollX = 0;
let targetScrollX = 0;
let spacing = 520; 
let ultramarine = [18, 10, 143];

function setup() {
    createCanvas(windowWidth, windowHeight);
    albums.forEach((album, i) => {
        loadedCovers[i] = loadImage(album.cover);
    });
}

function draw() {
    background(224);
    scrollX = lerp(scrollX, targetScrollX, 0.1);
    drawUI();

    for (let r = 0; r < 2; r++) {
        let rowY = map(r, 0, 1, height * 0.35, height * 0.75);
        drawRow(r, rowY);
    }

    if (keyIsDown(LEFT_ARROW)) targetScrollX += 18;
    if (keyIsDown(RIGHT_ARROW)) targetScrollX -= 18;
}

function drawUI() {
    push();
    textAlign(CENTER);
    textStyle(BOLD);
    fill(ultramarine);
    textSize(50);
    text("SPOT!MASH", width/2, 60);
    textSize(11);
    textStyle(NORMAL);
    text("EVERY CHARACTER HAS A UNIQUE CHILL DANCE | CLICK TO PLAY", width/2, 90);
    pop();
}

function drawRow(rowNum, y) {
    let rowAlbums = albums.filter(a => a.row === rowNum);
    push();
    translate(scrollX, 0);
    rowAlbums.forEach((album, i) => {
        let x = (width / 2) + (i * spacing) - (rowAlbums.length * spacing / 2.5);
        let imgIdx = albums.indexOf(album);
        
        let realX = x + scrollX;
        let isOverDancer = dist(mouseX, mouseY, realX - 145, y + 20) < 60;
        
        drawDancer(x - 145, y, imgIdx, isOverDancer, album.danceStyle);
        drawCover(x, y, album, loadedCovers[imgIdx]);
    });
    pop();
}

function drawDancer(x, y, idx, isDancing, style) {
    fill(ultramarine);
    textSize(22);
    textFont('monospace');
    textAlign(CENTER);
    
    let headY = sin(frameCount * 0.08 + idx) * 5;
    let arms = "/|\\";
    let legs = "/ \\";
    let xOff = 0;

    if (isDancing) {
        let slowTime = frameCount * 0.05;
        
        if (style === 0) { // THE NODDER: Solo testa e braccia su/giù
            headY = sin(slowTime * 2) * 10;
            arms = (sin(slowTime * 2) > 0) ? "_|_" : "/|\\";
        } 
        else if (style === 1) { // THE SHAKER: Spostamento laterale e braccia oblique
            xOff = sin(slowTime * 2) * 8;
            arms = (xOff > 0) ? "\\|/" : "/|\\";
        } 
        else if (style === 2) { // THE WAVER: Braccia che oscillano alternate
            arms = (floor(frameCount * 0.07) % 2 === 0) ? "v|v" : "^|^";
            headY = 2;
        } 
        else if (style === 3) { // THE BENDER: Gambe e testa
            legs = (sin(slowTime * 2) > 0) ? "| |" : "/ \\";
            headY = sin(slowTime * 2) * 6;
        }
    }

    push();
    translate(x + xOff, y);
    text("  O  ", 0, headY); 
    text(arms, 0, 22);      
    text(legs, 0, 44);      
    pop();
}

function drawCover(x, y, album, img) {
    rectMode(CENTER);
    let isHover = dist(mouseX - scrollX, mouseY, x, y) < 95;
    stroke(ultramarine);
    strokeWeight(isHover ? 4 : 1);
    noFill();
    rect(x, y, 180, 180);
    if (img && img.width > 1) {
        imageMode(CENTER);
        image(img, x, y, 172, 172);
    }
    noStroke();
    textAlign(CENTER);
    fill(ultramarine);
    textSize(11);
    textStyle(BOLD);
    text(album.title.toUpperCase(), x, y + 115);
    textStyle(NORMAL);
    textSize(9);
    text(album.artist, x, y + 130);
}

function mousePressed() {
    for (let r = 0; r < 2; r++) {
        let rowY = map(r, 0, 1, height * 0.35, height * 0.75);
        let rowAlbums = albums.filter(a => a.row === r);
        rowAlbums.forEach((album, i) => {
            let x = (width / 2) + (i * spacing) - (rowAlbums.length * spacing / 2.5);
            if (mouseX > (x + scrollX) - 90 && mouseX < (x + scrollX) + 90 &&
                mouseY > rowY - 90 && mouseY < rowY + 90) {
                let searchQuery = encodeURIComponent(album.artist + " " + album.title);
                window.open("https://www.youtube.com/results?search_query=" + searchQuery, '_blank');
            }
        });
    }
}

function mouseWheel(event) { targetScrollX -= event.delta; }
function windowResized() { resizeCanvas(windowWidth, windowHeight); }
</script>
</body>
</html>